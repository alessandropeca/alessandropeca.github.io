<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My First Webpage</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="header-content">
            <img src="imgs/A_Peca_profile_pic.jpg" alt="My Face" class="profile-pic">
            <h1>Welcome to My Webpage</h1>
        </div>
        <nav>
            <ul>
                <li><a href="#about">About</a></li>
                <li><a href="#hobbies">Hobbies</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <section id="about">
            <h2>About Me</h2>
            <p>Here is some information about me.</p>
        </section>
        
        <section id="hobbies">
            <h2>My Hobbies</h2>
            <ul>
                <li>Reading</li>
                <li>Coding</li>
                <li>Hiking</li>
            </ul>
        </section>
        
        <section id="publications">
            <h2>Publications</h2>
            <input type="text" id="search-query" placeholder="Enter author name">
            <button onclick="fetchADSData()">Search</button>
            <div class="publications-box" id="ads_query_results">
                <!-- Results will be inserted here -->
            </div>
        </section>
        
        <section id="contact">
            <h2>Contact Me</h2>
            <p>You can contact me at <a href="mailto:peca.alessandro@gmail.com">peca.alessandro@gmail.com</a>.</p>
        </section>
    </main>
    <footer>
        <p>&copy; 2024 Alessandro Peca's Webpage. All rights reserved.</p>
    </footer>

    <script>
        async function fetchADSData() {
            const queryInput = document.getElementById('search-query');
            const author = queryInput.value || 'peca, alessandro';
            const resultsDiv = document.getElementById('ads_query_results');
            resultsDiv.innerHTML = '';  // Clear previous results

            try {
                // All papers query
                const queryAll = new URLSearchParams({
                    q: `author:${author}`,
                    fl: 'title, author, date, citation_count, bibcode',
                    rows: 200
                });

                const responseAll = await fetch(`https://cors-anywhere.herokuapp.com/https://api.adsabs.harvard.edu/v1/search/query?${queryAll}`, {
                    headers: {
                        'Authorization': `Bearer Jqi8dLve7H7ixzmh0XQirKjB4miSf2Tnre3khV8y`
                    }
                });

                if (!responseAll.ok) {
                    throw new Error(`Query failed: ${responseAll.status} ${responseAll.statusText}`);
                }

                const resultsAll = await responseAll.json();
                console.log("API Response:", resultsAll);
                displayResults(resultsAll, 'All Papers', resultsDiv);

            } catch (error) {
                resultsDiv.innerHTML = `<p>Error: ${error.message}</p>`;
                console.error("Fetch Error:", error);
            }
        }

        function displayResults(results, title, container) {
            const section = document.createElement('section');
            const header = document.createElement('h2');
            header.textContent = title;
            section.appendChild(header);

            if (results.response && results.response.docs) {
                const list = document.createElement('ul');
                results.response.docs.forEach(doc => {
                    const item = document.createElement('li');
                    item.innerHTML = `<strong>${doc.title[0]}</strong> by ${doc.author.join(', ')} (${doc.date}) - Citations: ${doc.citation_count} - <a href="https://ui.adsabs.harvard.edu/abs/${doc.bibcode}" target="_blank">ADS Link</a>`;
                    list.appendChild(item);
                });
                section.appendChild(list);
            } else {
                section.innerHTML += '<p>No results found.</p>';
            }

            container.appendChild(section);
        }

        // Automatically run the query when the page loads
        window.onload = fetchADSData;
    </script>
</body>
</html>
